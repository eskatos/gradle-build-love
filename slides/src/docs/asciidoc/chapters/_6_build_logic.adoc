[background-color="#02303a"]
== Logique de build
image::gradle/bg-11.png[background, size=cover]

&#x1F9F0;


=== Phases d'un build
image::gradle/bg-11.png[background, size=cover]

* Configuration
* Calcul du graphe de tâches
* Execution du travail


[background-color="#02303a"]
=== Démo
image::gradle/bg-11.png[background, size=cover]

[.notes]
--
Observation d'un simple build
CLI/IDE
Build Scan
--


=== Logique de build
image::gradle/bg-11.png[background, size=cover]

Scripts du build vs. Plugins

* Les scripts du build sont déclaratifs
* Les plugins locaux au build implémentent la logique de configuration du build
* La logique de build utilise des plugins externes


=== Blocs de construction
image::gradle/bg-11.png[background, size=cover]

[cols="<.^1,^.^2",frame=none,grid=none]
|===
a|
* Plugins
* Extensions de DSL
* Tâches

a|
include::../fragments/_diagram_how-it-works.adoc[]
|===


=== Modèle de programmation
image::gradle/bg-11.png[background, size=cover]

include::../fragments/_diagram_build-logic-parts.adoc[]


=== Modèle de programmation
image::gradle/bg-11.png[background, size=cover]

* Don't call us, we'll call you! +
  _Sugarloaf^WHollywood_
* `(abstract class|interface)` +
  `MyType extends GradleApiType` +
  *instancié et décoré par Gradle*
* Services Gradle injectés +
  `@Inject`


=== Beans ?
image::gradle/bg-11.png[background, size=cover]

* Oui et non
* JavaBeans + `Property<T>`
* La convention JavaBeans apporte de l'interop avec Groovy et Kotlin
* `Property<T>` associe une propriété à ses dépendances dans le build et plus


[background-color="#02303a"]
=== Démo
image::gradle/bg-11.png[background, size=cover]

[.notes]
--
Montrer le plugin de démo, son extension DSL et ses tâches
TRANSITION: tout ça c'est du code, et le code ça se teste
--


=== Tester c'est douter
image::gradle/bg-11.png[background, size=cover]

[cols="<.^1,^.^1",frame=none,grid=none]
|===
a|
* Tests unitaires +
`ProjectBuilder`
* Tests d'intégration +
`Gradle TestKit`

a|
image::tester-cest-douter.jpeg[]
|===


=== Tests unitaires
image::gradle/bg-11.png[background, size=cover]

* `ProjectBuilder`
* TODO


=== Tests d'intégration
image::gradle/bg-11.png[background, size=cover]

* `Gradle TestKit`
* TODO


[background-color="#02303a"]
=== Démo
image::gradle/bg-11.png[background, size=cover]

[.notes]
--
Montrer et expliquer les tests du plugin de démo
--


=== Gradle TestKit
image::gradle/bg-11.png[background, size=cover]

* Comment tester des scénarios et lesquels sont importants
* Tester plusieurs versions de Gradle
* TODO


=== Plugins
image::gradle/bg-11.png[background, size=cover]

* Cibles de plugin : `Project`, `Settings` ou `Gradle`
* Equivalence en scripts : _project script_, _settings script_, _init script_
*

=== Plugins & extensions
image::gradle/bg-11.png[background, size=cover]


=== Plugins & tâches
image::gradle/bg-11.png[background, size=cover]

* Build incrémental - inputs/outputs
* Build cache - cache des outputs
* Tâches incrémentales - e.g. compilation


=== Configuration différée
image::gradle/bg-11.png[background, size=cover]

* `Property`/`Provider`
* Conteneurs
* Extensions => Tasks
* afterEvaluate
* Ordre
*
* TODO


=== Injection de services
image::gradle/bg-11.png[background, size=cover]

* TODO


=== Build services
image::gradle/bg-11.png[background, size=cover]

_ Services de build partagés ou _shared build services_
* TODO

